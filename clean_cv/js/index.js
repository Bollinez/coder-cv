const origobj = {
  "summarybanner": {
    "name": "Sydney Hillen",
    "image": "../pycv/img/cv_img.jpg",
    "summary": "A summary of Bolli… (the Bol)"
  },
  "personalscontainer": {
    "address-string": "Obere Belchenstr 17, 5012 Schoenenwerd",
    "mail": "sydney.hillen@outlook.com",
    "mobile": "+41 76 565 3714",
    "linkedin": "/sydney-hillen/"
  },
  "workxp-list": [
    {
      "department": "(Quantitative Analysis and Technology – Credit Suisse AG, Zurich)",
      "workxp-title": "Senior Quantitative Analyst",
      "workxp-time": "02/23-present",
      "workxp-description": [
        "development and maintenance of credit risk models using advanced statistical methods, including machine learning models such as gradient boosting or lasso regression in R",
        "application of standards for code versioning and documentation, as well as issue management using git and Odyssey Bitbucket",
        "project plan and workflow management using Jira and Kanban",
        "development of a model prototype using Fsharp and Angular as a proof of concept to move from a waterfall delivery model to a continuous integration and continuous delivery (CI/CD) practice",
        "automation of the economic downturn analysis for internal-rating-based (IRB) modelling using R Markdown, including: placeholdersubtasks"
      ],
      "workxp-description-sub": [
        "collection, processing and aggregation of macroeconomic data from external sources using R and PL/SQL",
        "application of regulatory standards for the estimation of economic downturns on portfolio-level"
      ]
    },
    {
      "department": "(Quantitative Analysis and Technology – Credit Suisse AG, Zurich)",
      "position": "Senior Model Developer",
      "workxp-time": "08/20-02/23",
      "maintasks": [
        "development and implementation of processes for the monitoring and backtesting of credit risk models using R and Python",
        "automation of report production for senior management and Swiss Financial Market Supervisory Authority (FINMA) using Python"
      ],
      "subtasks": []
    },
    {
      "department": "(Basel Measurement and Reporting – Credit Suisse AG, Zurich)",
      "position": "Line Management – Regulatory Reporting (IB)",
      "workxp-time": "10/19-08/20",
      "maintasks": [
        "improvement of data quality for Basel III regulatory reporting purposes, by supporting the implementation and testing of change requests from the business side",
        "reduction of dependencies from multiple web-based BI tools with limited third-party application compatibility and shifting the team's data sourcing towards SQL- and Python-based queries",
        "review of Compliance- and MIS reports for credit risk- and balance sheet figures for the Swiss Investment Banking business"
      ],
      "subtasks": []
    },
    {
      "department": "(Basel Measurement and Reporting – Credit Suisse AG, Zurich)",
      "position": "Regulatory Reporting (PB)",
      "workxp-time": "01/17-10/19",
      "maintasks": [
        "preparation and presentation of main drivers for credit risk movements to the CFO of Credit Suisse (Switzerland) Ltd.",
        "performance of test cases and validations for the decommissioning and replacement of applications used for regular business processes",
        "participation in the working group targeting more frequent reporting cycles as the SME for data flows within PB-related regulatory reporting processes"
      ],
      "subtasks": []
    }
  ],
  "student-workxp": [
    {
      "department": "Asset Liability Management – Sparkasse KölnBonn, Cologne",
      "student-workxp-time": "01/15-03/15",
      "tasks": "Within my internship at Sparkasse KölnBonn I provided assistance to financial engineers, primarily responsible for the management of interest rate risks and asset-/ liability mismatches, but also hat the chance to collaborate with BlackRock representatives for the preparation of the bank's role as a custodian for umbrella funds."
    },
    {
      "department": "Controlling – Bosch Rexroth AG, Witten",
      "student-workxp-time": "02/14-08/14",
      "tasks": "My primary responsibilities included the development and improvement of budget planning processes and standardized management control systems."
    },
    {
      "department": "Consulting – amx consulting, Hagen",
      "student-workxp-time": "01/11-02/11",
      "tasks": "I conducted research and analyses on candidate profiles for management positions in the fields of search engine optimisation and online media."
    }
  ],
  "education": [
    {
      "institution": "FernUniversität Hagen",
      "area": "Applied Computer Science",
      "studyType": "Master of Science",
      "education-time": "2022-2025 (approx.)",
      "details": {},
      "topics": [
        "Architecture and Implementation of Databases",
        "Parallel Programming",
        "Data Engineering for Data Science"
      ]
    },
    {
      "institution": "International School of Management Dortmund",
      "area": "Finance",
      "studyType": "Master of Science",
      "education-time": "09/14-12/16",
      "details": {
        "grade": "Excellent with 1.39",
        "semesterabroad": {
          "institution": "Oxford Brookes University, Oxford",
          "grade": "Excellent with 1.0",
          "education-time": "09/15-12/15"
        }
      },
      "topics": ["Portfolio Modelling (C# based)", "Asset Management"]
    },
    {
      "institution": "International School of Management Dortmund",
      "area": "International Management",
      "studyType": "Bachelor of Arts",
      "education-time": "09/10-08/14",
      "details": {
        "grade": "Good with 2.1",
        "semesterabroad": {
          "institution": "European Business School, Dublin",
          "grade": "Excellent with 1.0",
          "education-time": "01/12-04/12"
        }
      },
      "topics": ["Project Management", "Finance"]
    }
  ],
  "certificates": [
    {
      "name": "Financial Risk Manager",
      "date": "2019",
      "issuer": "Global Association of Risk Professionals",
      "image": "../pycv/img/frm_badge.png"
    },
    {
      "name": "Microsoft Certified: Azure Fundamentals",
      "date": "2023",
      "issuer": "Microsoft",
      "image": "../pycv/img/azure_badge.png"
    }
  ],
  "skills": {
    "verygood": ["PL/SQL", "R", "Markdown", "git", "Python", "VBA", "JSON"],
    "good": ["FSharp", "SAS", "Anaconda", "Kanban", "HTML", "CSS"],
    "fundamentals": [
      "Java",
      "jQuery",
      "JavaScript",
      "Azure",
      "C#",
      "Docker",
      "Angular",
      "Tableau"
    ]
  },
  "languages": {
    "native": "German",
    "fluent": "English",
    "good": "Spanish"
  },
  "interests": {
    "active": ["my dog", "hiking", "basketball", "shooting range"],
    "not_active": [
      "expanding my coding skills",
      "physical cosmology",
      "astronomy"
    ]
  },
  "references": [
    {
      "name": "Dorothee Bill",
      "company": "Credit Suisse",
      "relationship": "Former manager",
      "title": "Head of IRB Swiss Bank",
      "department": "Quantitative Analysis and Technology",
      "contact": "0123456789"
    },
    {
      "name": "Dr. Massimo Cutaia",
      "company": "Credit Suisse",
      "relationship": "Hiring manager",
      "title": "Global Head of Core Credit Modelling",
      "department": "Quantitative Analysis and Technology",
      "contact": "0123456789"
    },
    {
      "name": "André Rebmann",
      "company": "Credit Suisse",
      "relationship": "Former manager",
      "title": "Head of Swiss ",
      "department": "Basel Measurement and Reporting",
      "contact": "0123456789"
    }
  ],
  "projects_clubs": [
    "CS Group Finance Innovation Circle (2018-2020)",
    "CS Valuation in Resolution Data Sourcing (2019)",
    "CS BMR Innovation Circle & Co-Project lead for Python & R process automation (2018)"
  ]
}

const education_obj = {
  "education": [
    {
      "institution": "FernUniversität Hagen",
      "area": "Applied Computer Science",
      "studyType": "Master of Science",
      "education-time": "2022-2025 (approx.)",
      //"details": {},
      "topics": [
        "Architecture and Implementation of Databases",
        "Parallel Programming",
        "Data Engineering for Data Science"
      ]
    },
    {
      "institution": "International School of Management Dortmund",
      "area": "Finance",
      "studyType": "Master of Science",
      "education-time": "09/14-12/16",
      "details": {
        "grade": "Excellent with 1.39",
        "semesterabroad": {
          "institution": "Oxford Brookes University, Oxford",
          "grade": "Excellent with 1.0",
          "education-time": "09/15-12/15"
        }
      },
      "topics": ["Portfolio Modelling (C# based)", "Asset Management"]
    },
    {
      "institution": "International School of Management Dortmund",
      "area": "International Management",
      "studyType": "Bachelor of Arts",
      "education-time": "09/10-08/14",
      "details": {
        "grade": "Good with 2.1",
        "semesterabroad": {
          "institution": "European Business School, Dublin",
          "grade": "Excellent with 1.0",
          "education-time": "01/12-04/12"
        }
      },
      "topics": ["Project Management", "Finance"]
    } 
  ]
}
//console.log(getDepth(education_obj.education[1]))

const testobjkurz = {"projects_clubs": "test"}
//1: 

const testobj2 = {"projects_clubs": [
  "CS Group Finance Innovation Circle (2018-2020)",
  "CS Valuation in Resolution Data Sourcing (2019)",
  "CS BMR Innovation Circle & Co-Project lead for Python & R process automation (2018)"
]}
//2

const testobj3 = {
  "references": [
    {
      "name": "Dorothee Bill",
      "company": "Credit Suisse",
      "relationship": "Former manager",
      "title": "Head of IRB Swiss Bank",
      "department": "Quantitative Analysis and Technology",
      "contact": "0123456789"
    },
    {
      "name": "Dr. Massimo Cutaia",
      "company": "Credit Suisse",
      "relationship": "Hiring manager",
      "title": "Global Head of Core Credit Modelling",
      "department": "Quantitative Analysis and Technology",
      "contact": "0123456789"
    },
    {
      "name": "Dr. Massimo Cutaia2",
      "company": "Credit Suisse",
      "relationship": "Hiring manager",
      "title": "Global Head of Core Credit Modelling",
      "department": "Quantitative Analysis and Technology",
      "contact": "0123456789"
    }
  ]}
//3
const testobj4 = {
  "references": [
    {
      "name": "Dorothee Bill",
      "title": "Head of IRB Swiss Bank",
      "relationship": "Former manager",
      "department": "QAT",
      "contact": "0123456789",
      "topics": ["Portfolio Modelling (C# based)", "Asset Management"]
    },
    {
      "name": "Dr. Massimo Cutaia",
      "title": "Global Head of Core Credit Modelling",
      "relationship": "Hiring manager",
      "department": "QAT",
      "contact": "0123456789",
      "topics": ["oink", "barg"]
    }
  ]}
//4
//console.log(getDepth(testobj3.references))


const testobj = {"projects_clubs": [
  "CS Group Finance Innovation Circle (2018-2020)",
  "CS Valuation in Resolution Data Sourcing (2019)",
  "CS BMR Innovation Circle & Co-Project lead for Python & R process automation (2018)"
]}


//var datakeys = Object.keys(testobj);

var listItem = "";
var listHTML = "";
//console.log(getDepth(education_obj.education[1]))
console.log(nestedLoop(education_obj));

function nestedLoop(obj) {
  const res = {};
  var parentkey = [];
  var newdepth = 0;
  var depthobj  = 0;
  var delta = 0;
  var datakeys = Object.keys(obj);
  if(Array.isArray(obj[datakeys[0]])) {var countParentObj = obj[datakeys[0]].length} else {var countObj = -1};
  //var datakeys = Object.keys(obj);
  function recurse(obj, current) {
    
    //newdepth = getDepth(obj[datakeys[0]]);
    
    //console.log('depth ' + newdepth);
      for (const key in obj) {
       // if(Array.isArray(obj[key]) && typeof obj[key][0] === 'object') {var countObj = obj[key].length - 1} else {var countObj = -1};

          let value = obj[key];
          //let i = 0;
          if(value != undefined) {
              if (value && typeof value === 'object') {
                if (Array.isArray(value) && typeof value[0] === 'string' && value.length > 0) {
                  //console.log(key.toString() + '_' +  value);

                  iterateList(value, key);
                  console.log(key.toString() + listHTML);
               // } else if (Array.isArray(value) && typeof value[0] === 'object') {

                
                } else if (Object.keys(value).length > 0) {
                  if(key.toString().length == 1 && Number.parseInt(key) > 0) {
                    
                if(newdepth == 0) {depthobj = getDepth(value);} else {depthobj = newdepth;}
                newdepth = getDepth(value);
                delta = Math.max(0,newdepth - depthobj + 1);
          console.log('_______');
          console.log('depth ' + newdepth);
          console.log('olddepth ' + depthobj);
          console.log(parentkey);
          for (let i = 0; i < delta; i++) {
            
            console.log("pop");
            parentkey.pop();
          }
                    //console.log("pop");
                    //parentkey.pop();
                    console.log(parentkey);
                    console.log("push");
                    parentkey.push(key.toString());
                    console.log(parentkey);
                    console.log('_______');
                  } else {
                    
                if(newdepth == 0) {depthobj = getDepth(value);} else {depthobj = newdepth;}
                newdepth = getDepth(value);
                delta = Math.max(0,newdepth - depthobj + 1);
          console.log('_______');
          console.log('depth ' + newdepth);
          console.log('olddepth ' + depthobj);
          console.log(parentkey);
                    console.log("push only");
                    parentkey.push(key.toString());
                    console.log(parentkey);
                    console.log('_______');
                  }
                //console.log(key);
               // console.log('typeof value[0]: ' + typeof value[0] +' ... typeof value: ' + typeof value + ' .... ' + value);
               // console.log('typeof key[0]: ' + typeof key[0] +' ... typeof key: ' + typeof key + ' .... ' + key);
                }
                  recurse(value, key);
                  
              } else if (key.toString().length > 1 && typeof key === 'string' && value && typeof value === 'string') {
                  // Do your stuff here to var value
                  console.log(parentkey.join('_') +  '_'  + key + ': ' + value);
                  
                  //console.log('depth ' + depthobj);
                  //var parentkey = [];
              } else {
                res[key] = value;
                //console.log("else");
              }
              
          }
      }
  }
  recurse(obj);
  return res;
}

function getDepth(obj){
  if(!obj || obj.length===0 || typeof(obj)!=="object") return 0;
  const keys = Object.keys(obj);
  let depth = 0;
  keys.forEach(key=>{
      let tmpDepth = getDepth(obj[key]);
      if(tmpDepth>depth){
          depth = tmpDepth;
      }
  })
  return depth+1;
}

function iterateList(object, arrayname) {
  let objarr = object;
  listHTML = '';
  listItem = '';
  objarr.forEach(createHTMLList);
  listHTML += listItem;
  //console.log(listHTML);
 // document.getElementById(arrayname).innerHTML = listHTML;
}

function createHTMLList(value) {
  listItem += "<li>" + value + "</li>";
} 